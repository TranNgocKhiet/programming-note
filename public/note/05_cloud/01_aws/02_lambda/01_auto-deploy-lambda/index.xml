<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Auto deploy code from S3 to Lambda with Gitlab CI/CD Pipelines :: IT From Scratch</title>
    <link>//localhost:1313/note/05_cloud/01_aws/02_lambda/01_auto-deploy-lambda/index.html</link>
    <description>Template&#xD;stages: - deploy deploy_lambda_job: stage: deploy image: name: amazon/aws-cli:latest entrypoint: [&#34;&#34;] rules: - if: &#39;$CI_COMMIT_BRANCH == &#34;main&#34;&#39; changes: - lambda/**/* before_script: - yum install -y zip script: | echo &#34;--- Bắt đầu deploy Lambda (Chạy song song) ---&#34; cd lambda # Kiểm tra xem có file .py nào không để tránh lỗi nếu folder rỗng if ls *.py 1&gt; /dev/null 2&gt;&amp;1; then for file in *.py; do func_name=$(basename &#34;$file&#34; .py) echo &#34;&gt;&gt;&gt; Đang xử lý: $func_name&#34; # 1. Zip file zip -j &#34;${func_name}.zip&#34; &#34;$file&#34; # 2. Upload S3 echo &#34;Upload $func_name lên S3...&#34; aws s3 cp &#34;${func_name}.zip&#34; &#34;s3://$S3_BUCKET_LAMBDA/functions/${func_name}.zip&#34; --region $AWS_DEFAULT_REGION # 3. Update Lambda echo &#34;Update code cho Lambda function...&#34; aws lambda update-function-code \ --function-name &#34;$func_name&#34; \ --s3-bucket &#34;$S3_BUCKET_LAMBDA&#34; \ --s3-key &#34;functions/${func_name}.zip&#34; \ --region $AWS_DEFAULT_REGION # Dọn dẹp rm &#34;${func_name}.zip&#34; done else echo &#34;Không tìm thấy file .py nào trong thư mục lambda.&#34; fi&#xD;Code explaination&#xD;rules: - if: &#39;$CI_COMMIT_BRANCH == &#34;main&#34;&#39; changes: - lambda/**/*&#xD;Chỉ chạy khi code được merge vào nhánh main và có sự thay đổi file trong thư mục lambda/ before_script: - yum install -y zip&#xD;Lệnh này cài đặt công cụ zip vì AWS Lambda yêu cầu code phải được nén thành file .zip trước khi upload. -y để tự động đồng ý (yes) khi cài đặt if ls *.py 1&gt; /dev/null 2&gt;&amp;1; then&#xD;1&gt; /dev/null: + 1: Số 1 (Standard Output - stdout) - Nơi xuất ra kết quả bình thường (Ví dụ: danh sách file). + &gt;: Dấu chuyển hướng (Redirect). + /dev/null: Đây là một file đặc biệt trong hệ thống Linux. Mọi thứ bạn ném vào đây sẽ biến mất vĩnh viễn. Nó giống như một cái thùng rác không đáy. + Ý nghĩa: “Nếu lệnh chạy thành công, hãy ném kết quả vào hố đen (đừng in ra màn hình)”.</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <atom:link href="//localhost:1313/note/05_cloud/01_aws/02_lambda/01_auto-deploy-lambda/index.xml" rel="self" type="application/rss+xml" />
  </channel>
</rss>